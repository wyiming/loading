(function(c){function p(){var a="[jquery.form] "+Array.prototype.join.call(arguments,"");(!window.console||!window.console.log)&&window.opera&&window.opera.postError&&window.opera.postError(a)}c.fn.ajaxSubmit=function(a){function f(b){function e(){function a(){try{var c=(n.contentWindow?n.contentWindow.document:n.contentDocument?n.contentDocument:n.document).readyState;p("state = "+c);"uninitialized"==c.toLowerCase()&&setTimeout(a,50)}catch(b){p("Server abort: ",b," (",b.name,")"),f(s),r&&clearTimeout(r),
r=void 0}}var b=j.attr("target"),g=j.attr("action");h.setAttribute("target",m);k||h.setAttribute("method","POST");g!=d.url&&h.setAttribute("action",d.url);!d.skipEncodingOverride&&(!k||/post/i.test(k))&&j.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});d.timeout&&(r=setTimeout(function(){t=!0;f(w)},d.timeout));var i=[];try{if(d.extraData)for(var l in d.extraData)i.push(c('<input type="hidden" name="'+l+'" />').attr("value",d.extraData[l]).appendTo(h)[0]);d.iframeTarget||(q.appendTo("body"),
n.attachEvent?n.attachEvent("onload",f):n.addEventListener("load",f,!1));setTimeout(a,15);h.submit()}finally{h.setAttribute("action",g),b?h.setAttribute("target",b):j.removeAttr("target"),c(i).remove()}}function f(a){if(!g.aborted&&!x){try{o=n.contentWindow?n.contentWindow.document:n.contentDocument?n.contentDocument:n.document}catch(b){p("cannot access response document: ",b),a=s}if(a===w&&g)g.abort("timeout");else if(a==s&&g)g.abort("server abort");else if(o&&o.location.href!=d.iframeSrc||t){n.detachEvent?
n.detachEvent("onload",f):n.removeEventListener("load",f,!1);var a="success",e;try{if(t)throw"timeout";var j="xml"==d.dataType||o.XMLDocument||c.isXMLDoc(o);p("isXml="+j);if(!j&&(window.opera&&(null==o.body||""==o.body.innerHTML))&&--u){p("requeing onLoad callback, DOM not available");setTimeout(f,250);return}var h=o.body?o.body:o.documentElement;g.responseText=h?h.innerHTML:null;g.responseXML=o.XMLDocument?o.XMLDocument:o;j&&(d.dataType="xml");g.getResponseHeader=function(a){return{"content-type":d.dataType}[a]};
h&&(g.status=Number(h.getAttribute("status"))||g.status,g.statusText=h.getAttribute("statusText")||g.statusText);var i=/(json|script|text)/.test((d.dataType||"").toLowerCase());if(i||d.textarea){var k=o.getElementsByTagName("textarea")[0];if(k)g.responseText=k.value,g.status=Number(k.getAttribute("status"))||g.status,g.statusText=k.getAttribute("statusText")||g.statusText;else if(i){var m=o.getElementsByTagName("pre")[0],v=o.getElementsByTagName("body")[0];m?g.responseText=m.textContent?m.textContent:
m.innerHTML:v&&(g.responseText=v.innerHTML)}}else"xml"==d.dataType&&(!g.responseXML&&null!=g.responseText)&&(g.responseXML=B(g.responseText));try{y=C(g,d.dataType,d)}catch(A){a="parsererror",g.error=e=A||a}}catch(z){p("error caught: ",z),a="error",g.error=e=z||a}g.aborted&&(p("upload aborted"),a=null);g.status&&(a=200<=g.status&&300>g.status||304===g.status?"success":"error");"success"===a?(d.success&&d.success.call(d.context,y,"success",g),l&&c.event.trigger("ajaxSuccess",[g,d])):a&&(void 0==e&&
(e=g.statusText),d.error&&d.error.call(d.context,g,a,e),l&&c.event.trigger("ajaxError",[g,d,e]));l&&c.event.trigger("ajaxComplete",[g,d]);l&&!--c.active&&c.event.trigger("ajaxStop");d.complete&&d.complete.call(d.context,g,a);x=!0;d.timeout&&clearTimeout(r);setTimeout(function(){d.iframeTarget||q.remove();g.responseXML=null},100)}}}var h=j[0],i,d,l,m,q,n,g,t,r;if(b)for(i=0;i<b.length;i++)c(h[b[i].name]).attr("disabled",!1);if(c(":input[name=submit],:input[id=submit]",h).length)alert('Error: Form elements must not have name or id of "submit".');
else if(d=c.extend(!0,{},c.ajaxSettings,a),d.context=d.context||d,m="jqFormIO"+(new Date).getTime(),d.iframeTarget?(q=c(d.iframeTarget),i=q.attr("name"),null==i?q.attr("name",m):m=i):(q=c('<iframe name="'+m+'" src="'+d.iframeSrc+'" />'),q.css({position:"absolute",top:"-1000px",left:"-1000px"})),n=q[0],g={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(a){var b=a===
"timeout"?"timeout":"aborted";p("aborting upload... "+b);this.aborted=1;q.attr("src",d.iframeSrc);g.error=b;d.error&&d.error.call(d.context,g,b,a);l&&c.event.trigger("ajaxError",[g,d,b]);d.complete&&d.complete.call(d.context,g,b)}},(l=d.global)&&!c.active++&&c.event.trigger("ajaxStart"),l&&c.event.trigger("ajaxSend",[g,d]),d.beforeSend&&!1===d.beforeSend.call(d.context,g,d))d.global&&c.active--;else if(!g.aborted){if(b=h.clk)if((i=b.name)&&!b.disabled)d.extraData=d.extraData||{},d.extraData[i]=b.value,
"image"==b.type&&(d.extraData[i+".x"]=h.clk_x,d.extraData[i+".y"]=h.clk_y);var w=1,s=2;d.forceSync?e():setTimeout(e,10);var y,o,u=50,x,B=c.parseXML||function(a,b){if(window.ActiveXObject){b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(a)}else b=(new DOMParser).parseFromString(a,"text/xml");return b&&b.documentElement&&b.documentElement.nodeName!="parsererror"?b:null},D=c.parseJSON||function(a){return window.eval("("+a+")")},C=function(a,b,d){var e=a.getResponseHeader("content-type")||
"",g=b==="xml"||!b&&e.indexOf("xml")>=0,a=g?a.responseXML:a.responseText;g&&a.documentElement.nodeName==="parsererror"&&c.error&&c.error("parsererror");d&&d.dataFilter&&(a=d.dataFilter(a,b));typeof a==="string"&&(b==="json"||!b&&e.indexOf("json")>=0?a=D(a):(b==="script"||!b&&e.indexOf("javascript")>=0)&&c.globalEval(a));return a}}}if(!this.length)return p("ajaxSubmit: skipping submit process - no element selected"),this;var k,b,j=this;"function"==typeof a&&(a={success:a});k=this.attr("method");b=
this.attr("action");(b=(b="string"===typeof b?c.trim(b):"")||window.location.href||"")&&(b=(b.match(/^([^#]+)/)||[])[1]);a=c.extend(!0,{url:b,success:c.ajaxSettings.success,type:k||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},a);b={};this.trigger("form-pre-serialize",[this,a,b]);if(b.veto)return p("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(a.beforeSerialize&&!1===a.beforeSerialize(this,a))return p("ajaxSubmit: submit aborted via beforeSerialize callback"),
this;var e,h,i=this.formToArray(a.semantic);if(a.data)for(e in a.extraData=a.data,a.data)if(a.data[e]instanceof Array)for(var l in a.data[e])i.push({name:e,value:a.data[e][l]});else h=a.data[e],h=c.isFunction(h)?h():h,i.push({name:e,value:h});if(a.beforeSubmit&&!1===a.beforeSubmit(i,this,a))return p("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[i,this,a,b]);if(b.veto)return p("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;e=c.param(i);
"GET"==a.type.toUpperCase()?(a.url+=(0<=a.url.indexOf("?")?"&":"?")+e,a.data=null):a.data=e;var m=[];a.resetForm&&m.push(function(){j.resetForm()});a.clearForm&&m.push(function(){j.clearForm()});if(!a.dataType&&a.target){var u=a.success||function(){};m.push(function(b){var e=a.replaceTarget?"replaceWith":"html";c(a.target)[e](b).each(u,arguments)})}else a.success&&m.push(a.success);a.success=function(b,c,e){for(var h=a.context||a,f=0,d=m.length;f<d;f++)m[f].apply(h,[b,c,e||j,j])};e=0<c("input:file",
this).length;l="multipart/form-data"==j.attr("enctype")||"multipart/form-data"==j.attr("encoding");!1!==a.iframe&&(e||a.iframe||l)?a.closeKeepAlive?c.get(a.closeKeepAlive,function(){f(i)}):f(i):(c.browser.msie&&"get"==k&&(e=j[0].getAttribute("method"),"string"===typeof e&&(a.type=e)),c.ajax(a));this.trigger("form-submit-notify",[this,a]);return this};c.fn.ajaxForm=function(a){if(0===this.length){var f=this.selector,k=this.context;if(!c.isReady&&f)return p("DOM not ready, queuing ajaxForm"),c(function(){c(f,
k).ajaxForm(a)}),this;p("terminating; zero elements found by selector"+(c.isReady?"":" (DOM not ready)"));return this}return this.ajaxFormUnbind().bind("submit.form-plugin",function(b){b.isDefaultPrevented()||(b.preventDefault(),c(this).ajaxSubmit(a))}).bind("click.form-plugin",function(a){var f=a.target,e=c(f);if(!e.is(":submit,input:image")){f=e.closest(":submit");if(0==f.length)return;f=f[0]}var h=this;h.clk=f;"image"==f.type&&(void 0!=a.offsetX?(h.clk_x=a.offsetX,h.clk_y=a.offsetY):"function"==
typeof c.fn.offset?(e=e.offset(),h.clk_x=a.pageX-e.left,h.clk_y=a.pageY-e.top):(h.clk_x=a.pageX-f.offsetLeft,h.clk_y=a.pageY-f.offsetTop));setTimeout(function(){h.clk=h.clk_x=h.clk_y=null},100)})};c.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};c.fn.formToArray=function(a){var f=[];if(0===this.length)return f;var k=this[0],b=a?k.getElementsByTagName("*"):k.elements;if(!b)return f;var j,e,h,i,l,m;j=0;for(l=b.length;j<l;j++)if(e=b[j],h=e.name)if(a&&k.clk&&
"image"==e.type)!e.disabled&&k.clk==e&&(f.push({name:h,value:c(e).val()}),f.push({name:h+".x",value:k.clk_x},{name:h+".y",value:k.clk_y}));else if((i=c.fieldValue(e,!0))&&i.constructor==Array){e=0;for(m=i.length;e<m;e++)f.push({name:h,value:i[e]})}else null!==i&&"undefined"!=typeof i&&f.push({name:h,value:i});if(!a&&k.clk&&(a=c(k.clk),b=a[0],(h=b.name)&&!b.disabled&&"image"==b.type))f.push({name:h,value:a.val()}),f.push({name:h+".x",value:k.clk_x},{name:h+".y",value:k.clk_y});return f};c.fn.formSerialize=
function(a){return c.param(this.formToArray(a))};c.fn.fieldSerialize=function(a){var f=[];this.each(function(){var k=this.name;if(k){var b=c.fieldValue(this,a);if(b&&b.constructor==Array)for(var j=0,e=b.length;j<e;j++)f.push({name:k,value:b[j]});else null!==b&&"undefined"!=typeof b&&f.push({name:this.name,value:b})}});return c.param(f)};c.fn.fieldValue=function(a){for(var f=[],k=0,b=this.length;k<b;k++){var j=c.fieldValue(this[k],a);null===j||("undefined"==typeof j||j.constructor==Array&&!j.length)||
(j.constructor==Array?c.merge(f,j):f.push(j))}return f};c.fieldValue=function(a,f){var k=a.name,b=a.type,j=a.tagName.toLowerCase();void 0===f&&(f=!0);if(f&&(!k||a.disabled||"reset"==b||"button"==b||("checkbox"==b||"radio"==b)&&!a.checked||("submit"==b||"image"==b)&&a.form&&a.form.clk!=a||"select"==j&&-1==a.selectedIndex))return null;if("select"==j){var e=a.selectedIndex;if(0>e)return null;for(var k=[],j=a.options,h=(b="select-one"==b)?e+1:j.length,e=b?e:0;e<h;e++){var i=j[e];if(i.selected){var l=
i.value;l||(l=i.attributes&&i.attributes.value&&!i.attributes.value.specified?i.text:i.value);if(b)return l;k.push(l)}}return k}return c(a).val()};c.fn.clearForm=function(){return this.each(function(){c("input,select,textarea",this).clearFields()})};c.fn.clearFields=c.fn.clearInputs=function(){var a=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var c=this.type,k=this.tagName.toLowerCase();a.test(c)||"textarea"==k?this.value=
"":"checkbox"==c||"radio"==c?this.checked=!1:"select"==k&&(this.selectedIndex=-1)})};c.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})};c.fn.enable=function(a){void 0===a&&(a=!0);return this.each(function(){this.disabled=!a})};c.fn.selected=function(a){void 0===a&&(a=!0);return this.each(function(){var f=this.type;"checkbox"==f||"radio"==f?this.checked=a:"option"==this.tagName.toLowerCase()&&(f=
c(this).parent("select"),a&&(f[0]&&"select-one"==f[0].type)&&f.find("option").selected(!1),this.selected=a)})}})(jQuery);
